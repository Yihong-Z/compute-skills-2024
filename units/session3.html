<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.54">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Chris Paciorek">
<meta name="dcterms.date" content="2024-05-29">

<title>Computational skills workshop</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../assets/styles.css">
<link rel="stylesheet" href="../styles.css">
</head>

<body>

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#our-running-example-newtons-method-for-optimization" id="toc-our-running-example-newtons-method-for-optimization" class="nav-link active" data-scroll-target="#our-running-example-newtons-method-for-optimization">1. Our running example: Newton’s method for optimization</a>
  <ul class="collapse">
  <li><a href="#newtons-method-background" id="toc-newtons-method-background" class="nav-link" data-scroll-target="#newtons-method-background">Newton’s method background</a></li>
  <li><a href="#exercise-implement-univariate-newtons-method" id="toc-exercise-implement-univariate-newtons-method" class="nav-link" data-scroll-target="#exercise-implement-univariate-newtons-method">Exercise: Implement univariate Newton’s method</a></li>
  </ul></li>
  <li><a href="#introduction-to-git-and-github" id="toc-introduction-to-git-and-github" class="nav-link" data-scroll-target="#introduction-to-git-and-github">2. Introduction to Git and GitHub</a>
  <ul class="collapse">
  <li><a href="#exercise-creating-a-git-repository-on-github" id="toc-exercise-creating-a-git-repository-on-github" class="nav-link" data-scroll-target="#exercise-creating-a-git-repository-on-github">Exercise: Creating a Git repository (on GitHub)</a></li>
  <li><a href="#accessing-github-repositories-from-jupyterhub" id="toc-accessing-github-repositories-from-jupyterhub" class="nav-link" data-scroll-target="#accessing-github-repositories-from-jupyterhub">Accessing GitHub repositories from JupyterHub</a></li>
  <li><a href="#basic-use-of-a-repository" id="toc-basic-use-of-a-repository" class="nav-link" data-scroll-target="#basic-use-of-a-repository">Basic use of a repository</a>
  <ul class="collapse">
  <li><a href="#writing-good-commit-messages" id="toc-writing-good-commit-messages" class="nav-link" data-scroll-target="#writing-good-commit-messages">Writing good commit messages</a></li>
  </ul></li>
  <li><a href="#exercise-code-review" id="toc-exercise-code-review" class="nav-link" data-scroll-target="#exercise-code-review">Exercise: code review</a></li>
  </ul></li>
  <li><a href="#understanding-git" id="toc-understanding-git" class="nav-link" data-scroll-target="#understanding-git">3. Understanding Git</a>
  <ul class="collapse">
  <li><a href="#key-components-and-terminology" id="toc-key-components-and-terminology" class="nav-link" data-scroll-target="#key-components-and-terminology">Key components and terminology</a>
  <ul class="collapse">
  <li><a href="#commits" id="toc-commits" class="nav-link" data-scroll-target="#commits">Commits</a></li>
  <li><a href="#a-repository" id="toc-a-repository" class="nav-link" data-scroll-target="#a-repository">A repository</a></li>
  <li><a href="#staging-area-index" id="toc-staging-area-index" class="nav-link" data-scroll-target="#staging-area-index">Staging area / index</a></li>
  </ul></li>
  <li><a href="#git-visuals-understanding-git-concepts" id="toc-git-visuals-understanding-git-concepts" class="nav-link" data-scroll-target="#git-visuals-understanding-git-concepts">Git visuals: Understanding Git concepts</a></li>
  </ul></li>
  <li><a href="#code-style-and-documentation" id="toc-code-style-and-documentation" class="nav-link" data-scroll-target="#code-style-and-documentation">4. Code style and documentation</a>
  <ul class="collapse">
  <li><a href="#linting" id="toc-linting" class="nav-link" data-scroll-target="#linting">Linting</a></li>
  <li><a href="#exercise-add-documentation-and-comments-to-your-newton-module" id="toc-exercise-add-documentation-and-comments-to-your-newton-module" class="nav-link" data-scroll-target="#exercise-add-documentation-and-comments-to-your-newton-module">Exercise: add documentation and comments to your Newton module</a></li>
  </ul></li>
  <li><a href="#debugging" id="toc-debugging" class="nav-link" data-scroll-target="#debugging">5. Debugging</a>
  <ul class="collapse">
  <li><a href="#demo-debugging-the-binary_search-example" id="toc-demo-debugging-the-binary_search-example" class="nav-link" data-scroll-target="#demo-debugging-the-binary_search-example">Demo: debugging the <code>binary_search</code> example</a></li>
  <li><a href="#exercise-debugging-your-newton-code" id="toc-exercise-debugging-your-newton-code" class="nav-link" data-scroll-target="#exercise-debugging-your-newton-code">Exercise: debugging your Newton code</a></li>
  </ul></li>
  <li><a href="#defensive-programming-error-checking-and-testing" id="toc-defensive-programming-error-checking-and-testing" class="nav-link" data-scroll-target="#defensive-programming-error-checking-and-testing">6. Defensive programming, error checking and testing</a>
  <ul class="collapse">
  <li><a href="#demo-unit-tests-and-pytest" id="toc-demo-unit-tests-and-pytest" class="nav-link" data-scroll-target="#demo-unit-tests-and-pytest">Demo: Unit tests and <code>pytest</code></a></li>
  <li><a href="#exercise-test-cases" id="toc-exercise-test-cases" class="nav-link" data-scroll-target="#exercise-test-cases">Exercise: Test cases</a></li>
  <li><a href="#exercise-unit-tests" id="toc-exercise-unit-tests" class="nav-link" data-scroll-target="#exercise-unit-tests">Exercise: Unit tests</a></li>
  <li><a href="#exercise-error-trapping-robust-code-and-defensive-programming" id="toc-exercise-error-trapping-robust-code-and-defensive-programming" class="nav-link" data-scroll-target="#exercise-error-trapping-robust-code-and-defensive-programming">Exercise: Error trapping, robust code, and defensive programming</a></li>
  </ul></li>
  <li><a href="#multi-user-git" id="toc-multi-user-git" class="nav-link" data-scroll-target="#multi-user-git">7. Multi-user Git</a>
  <ul class="collapse">
  <li><a href="#demo-branching-and-pull-requests-merge-conflicts" id="toc-demo-branching-and-pull-requests-merge-conflicts" class="nav-link" data-scroll-target="#demo-branching-and-pull-requests-merge-conflicts">Demo: Branching and pull requests, merge conflicts</a>
  <ul class="collapse">
  <li><a href="#branching" id="toc-branching" class="nav-link" data-scroll-target="#branching">Branching</a></li>
  <li><a href="#pull-requests" id="toc-pull-requests" class="nav-link" data-scroll-target="#pull-requests">Pull requests</a></li>
  <li><a href="#merge-conflicts" id="toc-merge-conflicts" class="nav-link" data-scroll-target="#merge-conflicts">Merge conflicts</a></li>
  </ul></li>
  <li><a href="#multivariate-newtons-method" id="toc-multivariate-newtons-method" class="nav-link" data-scroll-target="#multivariate-newtons-method">Multivariate Newton’s method</a></li>
  <li><a href="#exercise-branching" id="toc-exercise-branching" class="nav-link" data-scroll-target="#exercise-branching">Exercise: Branching</a></li>
  <li><a href="#exercise-pull-requests" id="toc-exercise-pull-requests" class="nav-link" data-scroll-target="#exercise-pull-requests">Exercise: Pull requests</a></li>
  <li><a href="#exercise-code-review-1" id="toc-exercise-code-review-1" class="nav-link" data-scroll-target="#exercise-code-review-1">Exercise: Code review</a></li>
  <li><a href="#exercise-merge-the-pr" id="toc-exercise-merge-the-pr" class="nav-link" data-scroll-target="#exercise-merge-the-pr">Exercise: Merge the PR</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Computational skills workshop</h1>
<p class="subtitle lead">Version control, programming, and testing</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Chris Paciorek </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 29, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
CJP development notes
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>links:</p>
<ul>
<li>https://software-carpentry.org/lessons/</li>
<li>https://ucb-stat-159-s23.github.io/site (/var/tmp/site/lectures/intro-git)</li>
<li>https://docs.google.com/document/d/1osbFw5hTnt7wH7xnm_lIf2l0Ffn5c-xHyPEssbBvGXo/edit</li>
</ul>
<p>export GIT_CONFIG_NOSYSTEM=1</p>
<p>NOTES: might need to set merging policy: git config pull.rebase false</p>
<p>install ruff in DataHub and on SCF</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Overview
</div>
</div>
<div class="callout-body-container callout-body">
<p>This module presents the core content of the workshop on version control (using Git), code style, documentation, and testing.</p>
</div>
</div>
<section id="our-running-example-newtons-method-for-optimization" class="level1">
<h1>1. Our running example: Newton’s method for optimization</h1>
<section id="newtons-method-background" class="level2">
<h2 class="anchored" data-anchor-id="newtons-method-background">Newton’s method background</h2>
<p>We’ll use a running example, Newton’s method for optimization, during this workshop. It’s simple enough to be straightforward to code but can involve various modifications, extensions, etc. to be a rich enough example that we can use it to demonstrate various topics and tools.</p>
<p>Recall that Newton’s method works as follows to optimize some objective function, <span class="math inline">\(f(x)\)</span> as a function of univariate or multivariate <span class="math inline">\(x\)</span>, where <span class="math inline">\(f(x)\)</span> is univariate.</p>
<p>Newton’s method is iterative. If we are at step <span class="math inline">\(t-1\)</span>, the next value is:</p>
<p><span class="math display">\[
x_t = x_{t-1} - f^{\prime}(x_{t-1}) / f^{\prime\prime}(x_{t-1})
\]</span></p>
<p>Here are the steps:</p>
<ul>
<li>determine a starting value, <span class="math inline">\(x_0\)</span></li>
<li>iterate:
<ul>
<li>at step <span class="math inline">\(t\)</span>, the next value (the update) is given by the equation above</li>
<li>stop when <span class="math inline">\(\left\Vert x_{t} - x_{t-1} \right\Vert\)</span> is “small”</li>
</ul></li>
</ul>
</section>
<section id="exercise-implement-univariate-newtons-method" class="level2">
<h2 class="anchored" data-anchor-id="exercise-implement-univariate-newtons-method">Exercise: Implement univariate Newton’s method</h2>
<p>Here’s what you’ll need your code to do:</p>
<ul>
<li>accept a starting value and the function to optimize</li>
<li>implement the iterative algorithm</li>
<li>implement the stopping criterion (feel free to keep this simple)</li>
<li>calculate the first and second derivatives using a basic finite difference approach to estimating the derivative based on the definition of a derivative as a limit
<ul>
<li>note that the second derivative can be seen as calling the first derivative twice…</li>
</ul></li>
<li>consider what to return as the output</li>
</ul>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Don’t make your finite difference (“epsilon”) too small or you’ll actually get inaccurate estimates. (We’ll discuss why when we talk a bit out numerical issues in computing later.)</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>For now, please do not use any Python packages that provide finite difference-based derivatives (we’ll do that later, and it’s helpful to have more code available for the work we’ll do today).</p>
</div>
</div>
<p>Put your code into a simple text file, called <code>newton.py</code>. In doing so you’ve created a Python <em>module</em>. You can use it like this:</p>
<div id="4a4d9037" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> newton</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>newton.optimize(start, fun)   <span class="co">## Assuming your function is called `optimize`.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A <em>module</em> is a collection of related code in a file with the extension <code>.py</code>. The code can include functions, classes, and variables, as well as runnable code. To access the objects in the module, you need to import the module.</p>
</section>
</section>
<section id="introduction-to-git-and-github" class="level1">
<h1>2. Introduction to Git and GitHub</h1>
<section id="exercise-creating-a-git-repository-on-github" class="level2">
<h2 class="anchored" data-anchor-id="exercise-creating-a-git-repository-on-github">Exercise: Creating a Git repository (on GitHub)</h2>
<p>Go to <code>github.com/&lt;your_username&gt;</code> and click on the <code>Repositories</code> tag. Then click on the <code>New</code> button. In the form, give the repository the name <code>newton-practice</code> (so others who are working with you can find it easily), provide a short description, and click on “Add a README file”. Leave the repository as “Public” so that others can interact with your repository when we practice later.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Creating repositories on your laptop first
</div>
</div>
<div class="callout-body-container callout-body">
<p>It’s also possible to <a href="https://docs.github.com/en/migrations/importing-source-code/using-the-command-line-to-import-source-code/adding-locally-hosted-code-to-github#initializing-a-git-repository">create the repository from the terminal on your machine</a> and then link it to your GitHub account, but that’s a couple extra steps we won’t go into here at the moment.</p>
</div>
</div>
</section>
<section id="accessing-github-repositories-from-jupyterhub" class="level2">
<h2 class="anchored" data-anchor-id="accessing-github-repositories-from-jupyterhub">Accessing GitHub repositories from JupyterHub</h2>
<p>Authenticating with GitHub can be a bit tricky, particularly when using DataHub (i.e., JupyterHub).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Accessing GitHub from your laptop rather than DataHub
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you’re on your laptop and already set up to use GitHub, you don’t need to do the steps in this section, but if you’re using your laptop and not set up to use GitHub, these instructions should work there too. (it may also depend on the version of <code>git</code> you are using; e.g., version 2.34.1 is too old but 2.39 should be fine).</p>
</div>
</div>
<p>We’ll use a tool (an ‘app’) that helps us with this, provided in the <code>gh_scoped_creds</code> Python package.</p>
<p>First configure git in the terminal:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> config <span class="at">--global</span> user.name <span class="st">"Jane Doe"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> config <span class="at">--global</span> user.email <span class="st">"jane_doe@berkeley.edu"</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> config <span class="at">--global</span> color.ui <span class="st">"auto"</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># git config pull.rebase false</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Then run this in the terminal:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">gh-scoped-creds</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Or you could instead run this in IPython or Jupyter Notebook:</p>
<div id="f526d8cd" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> gh_scoped_creds</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>ghscopedcreds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>When you do that you’ll see a link and a code. Go to the link in a browser and input the code; this will grant access to GitHub from JupyterHub for 8 hours (or until you stop your JupyterHub server).</p>
<p>Then (only the first time you are doing all this) go to the URL that is printed out (which should be <a href="https://github.com/apps/stat-computing-jupyterhub)" class="uri">https://github.com/apps/stat-computing-jupyterhub)</a> and click on <code>Install</code>. Choose “Only select repositories” and select the repository you are using for the workshop, namely <code>newton-practice</code>.</p>
</section>
<section id="basic-use-of-a-repository" class="level2">
<h2 class="anchored" data-anchor-id="basic-use-of-a-repository">Basic use of a repository</h2>
<p>In the terminal, let’s make a small change to the README, register the change with Git (this is called a <em>commit</em>), and push the changes upstream to GitHub (which has the <em>remote</em> copy of the repository).</p>
<section id="step-1.-clone-the-repository" class="level4">
<h4 class="anchored" data-anchor-id="step-1.-clone-the-repository">Step 1. Clone the repository</h4>
<p>First make a local copy of the repository from the remote on GitHub.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clone https://github.com/<span class="op">&lt;</span>your_username<span class="op">&gt;</span>/compute-skills-2024</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If we run this:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> compute-workshop-2024</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> <span class="at">-l</span> .git</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> .git/config</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>we should see a bunch of output (truncated here) indicating that <code>compute-workshop-2024</code> is a Git repository, and that in this case the local repository is linked to a <em>remote</em> repository (the repository we created on GitHub):</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">total</span> 56</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="ex">drwxr-xr-x</span>   2 paciorek scfstaff 4096 Jul 23 17:06 branches</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="ex">-rw-r--r--</span>   1 paciorek scfstaff   16 Jul 24 14:48 COMMIT_EDITMSG</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="ex">-rw-r--r--</span>   1 paciorek scfstaff  656 Jul 23 18:20 config</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>snip<span class="op">&gt;</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>snip<span class="op">&gt;</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="ex">[remote</span> <span class="st">"origin"</span>]</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="ex">url</span> = https://github.com/berkeley-scf/compute-skills-2024</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>snip<span class="op">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Step 2. Add files</p>
<p>Next move (or copy) your Python module into the repository directory. I’ll use the test module that we’ll work with later, but you’ll do it with your Newton method module.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> compute-workshop-2024</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> ../binary_search.py .</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">## Tell git to track the file</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> add binary_search.py</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Step 3. Edit file(s)</p>
<p>Edit the README file to indicate that the repository has a basic implementation of Newton’s method. (In DataHub, you can double-click on the README in the file manager pane.)</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Tell git to keep track of the changes to the file.</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> add README.md</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Register the changes with Git.</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">-m</span><span class="st">"Add basic implementation of binary search."</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">## Synchronize the changes with the remote.</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> push</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>We could have cloned the (public) repository without the <code>gh_scoped_creds</code> credentials stuff earlier, but if we tried to push to it, we would have been faced with GitHub asking for our password, which would have required us to create a GitHub authentication token that we would paste in.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Instead of having to <code>add</code> the README and <code>commit</code> separately we could do:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> add newton.py</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">-a</span> <span class="at">-m</span><span class="st">"added basic implementation of binary search"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>We do need to explicitly add any <strong>new</strong> files (e.g., <code>newton.py</code>) that are not yet registered with git via <code>git add</code>.</p>
</div>
</div>
</section>
<section id="writing-good-commit-messages" class="level3">
<h3 class="anchored" data-anchor-id="writing-good-commit-messages">Writing good commit messages</h3>
<p>Some tips:</p>
<ul>
<li>Concisely describe what changed (and for more complicated situations, why), not how.</li>
<li>Two options (depending on whether the commit makes one or more changes):
<ul>
<li>Keep it short (one line, &lt;72 characters)</li>
<li>Have a subject line separated from the body by a blank line.
<ul>
<li>Keep subject to 50 characters and each body line to 72 characters.</li>
<li>Best to edit message in an editor – omit the <code>-m</code> flag to <code>git commit</code>.</li>
</ul></li>
</ul></li>
<li>If you’re working on a project with GitHub issues, reference the issue at the bottom.</li>
<li>Start each item in the message with a verb (present tense) and provide a complete sentence.</li>
</ul>
<p>If you find your commit message is covering multiple topics, it probably means you should have made multiple (“atomic”) commits.</p>
</section>
</section>
<section id="exercise-code-review" class="level2">
<h2 class="anchored" data-anchor-id="exercise-code-review">Exercise: code review</h2>
<p>Go to your partner’s repository at <code>https://github.com/&lt;user_name&gt;/newton-practice</code>.</p>
<ol type="1">
<li>Look over their code.</li>
<li>Make some comments/suggestions in a new GitHub issue (go to the <code>Issues</code> button and click on <code>New issue</code>).</li>
</ol>
<p>In response to your partner’s comments, make some small change(s) to your <code>newton.py</code> code.</p>
<p>You can do this in DataHub (or locally on your laptop if that’s what you’re doing).</p>
<p>Or you can do the editing in your GitHub browser window by selecting <code>Code</code>, clicking on the file and choosing the pencil icon to edit it. When you save it, a commit will be made. Make sure to provide a commit message. In this case you’ll also want to run <code>git pull</code> to pull down the changes to your local repository on DataHub or your laptop.</p>
</section>
</section>
<section id="understanding-git" class="level1">
<h1>3. Understanding Git</h1>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
More than the syntax
</div>
</div>
<div class="callout-body-container callout-body">
<p>So far we’ve just introduced Git by its mechanics/syntax. This is ok (but not ideal) for basic one-person operation, but to really use Git effectively you need to understand conceptually how it works.</p>
<p>More generally if you understand things conceptually, then looking up the syntax of a command or the mechanics of how to do something will be straightforward.</p>
</div>
</div>
<section id="key-components-and-terminology" class="level2">
<h2 class="anchored" data-anchor-id="key-components-and-terminology">Key components and terminology</h2>
<section id="commits" class="level3">
<h3 class="anchored" data-anchor-id="commits">Commits</h3>
<p>A <em>commit</em> is a snapshot of our work at a point in time. So far we’ve been working with a linear sequence of snapshots, but we’ll see in a moment that we can actually have a directed acyclic graph (DAG) of snapshots once we have <em>branches</em>.</p>
<p>Each commit has:</p>
<ul>
<li>a hash identifier - a unique identifier produced by hashing the changes introduced in the commit and also the parent commit,</li>
<li>hashes of the files in the repository in their current state, and</li>
<li>the changes (from <code>diff</code>) relative to the parent commit.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="commit.png" class="img-fluid figure-img"></p>
<figcaption>A Git commit (Credit: ProGit book, CC License)</figcaption>
</figure>
</div>
</section>
<section id="a-repository" class="level3">
<h3 class="anchored" data-anchor-id="a-repository">A repository</h3>
<p>A <em>repository</em> is the set of files for a project with their history. It’s a collection of commits in the form of an acyclic graph.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="tree.png" class="img-fluid figure-img"></p>
<figcaption>A (simple) Git repository (Credit: ProGit book, CC License)</figcaption>
</figure>
</div>
<p>Some other terms:</p>
<ul>
<li>HEAD: a pointer to the current commit</li>
<li>tag: a label for a commit</li>
<li>branch: a commit - often indicating a commit that has “branched” off of some main workflow or some linear sequence of commits</li>
</ul>
</section>
<section id="staging-area-index" class="level3">
<h3 class="anchored" data-anchor-id="staging-area-index">Staging area / index</h3>
<p>The index (staging area) keeps track of changes (made to tracked files) that are not yet committed.</p>
<p>Here’s a visualization of <img src="staging.png" class="img-fluid" alt="local operations in a repository (Credit: ProGit book, CC License)"></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Rolling back changes (optional)
</div>
</div>
<div class="callout-body-container callout-body">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Uncommitted changes</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Staged but uncommitted changes</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Committed changes</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Pushed changes</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>If I make some changes to a file that I decide are a mistaken, before <code>git add</code> (i.e., before registering the changes with <code>git</code>). I can always still edit the file to undo the mistakes.</p>
<p>But I can also go back to the version stored by Git.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># git checkout -- file.txt</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> restore file.txt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>If we’ve added (staged) files via <code>git add</code> but have not yet committed them, the files are in the index (staging area). We can get those changes out of the staging area like this:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> status</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># git reset HEAD file.txt</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> restore <span class="at">--staged</span> file.txt</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> status</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Note that the changes still exist in <code>file.txt</code> but they’re no longer registered with Git.</p>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>Suppose you need to add or modify to your commit. This illustrates a few things you might do.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">-m</span> <span class="st">'Initial commit'</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> add forgotten_file.txt</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># edit file.txt</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> add file.txt</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># get version of file from previous commit</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> checkout <span class="op">&lt;</span>commit_hash<span class="op">&gt;</span> file.txt</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">--amend</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="sourceCode" id="cb15"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> revert <span class="op">&lt;</span>commit_hash<span class="op">&gt;</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> push</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Note that this creates a new commit that undoes the changes you don’t want. So the undoing shows up in the history. This is the safest option.</p>
<p>If you’re <em>sure</em> no one else has pulled your changes from the remote:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> reset <span class="op">&lt;</span>commit_hash<span class="op">&gt;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Make changes</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">-a</span> <span class="at">-m</span><span class="st">'reworked the mistake'</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> push <span class="at">-f</span> origin <span class="op">&lt;</span>branch_name<span class="op">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This will remove the previous commit at the remote.</p>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="git-visuals-understanding-git-concepts" class="level2">
<h2 class="anchored" data-anchor-id="git-visuals-understanding-git-concepts">Git visuals: Understanding Git concepts</h2>
<p>Fernando Perez has nice visualization (<a href="https://docs.google.com/presentation/d/1YlM3boYLE8DwbxGNO3ZVVt3e9gEoBgD1uc9RtItUYCU">online version</a>, <a href="git_visuals.pdf">PDF version</a>) of a basic Git workflow that we’ll walk through.</p>
<p>Note that we haven’t actually talked about some of what is shown in the visual: tags, branches, and merging, but we’ll see a bit in the visual and discuss more later.</p>
</section>
</section>
<section id="code-style-and-documentation" class="level1">
<h1>4. Code style and documentation</h1>
<p>Having a (reasonably) consistent and clean style, plus documentation, is important for being able to read and maintain your code.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Q: Who is the person most likely to use your code again?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>A: You, but at some point in the future by which you will have forgotten what the code does and why.</p>
<p>I can’t tell you how many times I’ve looked back at my own code and been amazed at how little I remember and frustrated with the former self who wrote it.</p>
</div>
</div>
</div>
<p>A go-to reference on Python code style is the <a href="https://peps.python.org/pep-0008">PEP8 style guide</a>. That said, it’s extensive, quite detailed, and hard to absorb quickly.</p>
<p>Here are a few key suggestions:</p>
<ul>
<li><p>Indentation:</p>
<ul>
<li>Python is strict about indentation of course.</li>
<li>Use 4 spaces per indentation level (avoid tabs if possible).</li>
</ul></li>
<li><p>Whitespace: use it in a variety of places. Some places where it is good to have it are</p>
<ul>
<li>around operators (assignment and arithmetic), e.g., <code>x = x * 3</code>;</li>
<li>between function arguments, e.g., <code>myfun(x, 3, data)</code>;</li>
<li>between list/tuple elements, e.g., <code>x = [3, 5, 7]</code>; and</li>
<li>between matrix/array indices, e.g., <code>x[3, :4]</code>.</li>
</ul></li>
<li><p>Use blank lines to separate blocks of code with comments to say what the block does.</p></li>
<li><p>Use whitespaces or parentheses for clarity even if not needed for order of operations. For example, <code>a/y*x</code> will work but is not easy to read and you can easily induce a bug if you forget the order of ops. Instead, use <code>a/y * x</code> or <code>(a/y) * x</code>.</p></li>
<li><p>Avoid code lines longer than 79 characters and comment/docstring lines longer than 72 characters.</p></li>
<li><p>Comments:</p>
<ul>
<li>Add comments to explain why, not how.</li>
<li>Don’t belabor the obvious; avoid things like <code>x = x + 1  # Increment x.</code>.</li>
<li>Some key things to document:
<ul>
<li>summarizing a block of code,</li>
<li>explaining a complicated piece of code or particular construction,</li>
<li>explaining non-obvious values or steps, such as <code>x = x + 1 # Compensate for border.</code></li>
</ul></li>
<li>Comments should generally be complete sentences.</li>
</ul></li>
<li><p>You can use parentheses to group operations such that they can be split up into lines and easily commented, e.g.,</p>
<div id="d73e233c" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>newdf <span class="op">=</span> (</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>        pd.read_csv(<span class="st">'file.csv'</span>)                   <span class="co"># 1988 census data.</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>        .rename(columns <span class="op">=</span> {<span class="st">'STATE'</span>: <span class="st">'us_state'</span>})  <span class="co"># Adjust column names.</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>        .dropna()                                 <span class="co"># Remove rows with missing values.</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>        )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>Being consistent about the naming style for objects and functions is hard, but try to be consistent. PEP8 suggests:</p>
<ul>
<li>Class names should be UpperCamelCase.</li>
<li>Function, method, and variable names should be snake_case, e.g., <code>number_of_its</code> or <code>n_its</code>.</li>
<li>Non-public methods and variables should have a leading underscore.</li>
</ul></li>
<li><p>Try to have the names be informative without being overly long.</p></li>
<li><p>Don’t overwrite names of objects/functions that already exist in Python. E.g., don’t use <code>len</code>. That said, the namespace system helps with the unavoidable cases where there are name conflicts.</p></li>
<li><p>Use active names for functions (e.g., <code>calc_loglik</code>, <code>calc_log_lik</code> rather than <code>loglik</code> or <code>loglik_calc</code>). Functions are akin to verbs.</p></li>
<li><p>Learn from others’ code</p></li>
</ul>
<section id="linting" class="level2">
<h2 class="anchored" data-anchor-id="linting">Linting</h2>
<p>Linting is the process of applying a tool to your code to enforce style.</p>
<p>We’ll demo using <code>ruff</code> to some example code. You might also consider <code>black</code>.</p>
<p>We’ll practice with <code>ruff</code> with a small module we’ll use next also for debugging.</p>
<ul>
<li><p>First, we check for and fix syntax errors.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ruff</span> check binary_search.py</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Then we ask <code>ruff</code> to reformat to conform to standard style.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ruff</span> format binary_search.py</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul>
<p>Let’s see what changed:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span> binary_search_orig.py binary_search.py</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="exercise-add-documentation-and-comments-to-your-newton-module" class="level2">
<h2 class="anchored" data-anchor-id="exercise-add-documentation-and-comments-to-your-newton-module">Exercise: add documentation and comments to your Newton module</h2>
<ol type="1">
<li>Add a <a href="https://peps.python.org/pep-0257">doc string</a> to each of your functions. Focus on your main function. Take a look at an example, such as <code>help(numpy.linalg.cholesky)</code> to see the different parts and the format.</li>
<li>Consider whether to add comments to your code.</li>
<li>Apply <code>ruff</code> to your code.</li>
<li>Compare the results with the style suggestions above and do additional reformatting as needed.</li>
</ol>
</section>
</section>
<section id="debugging" class="level1">
<h1>5. Debugging</h1>
<p>Once you start writing more complicated code, even in an interpreted language such as Python that you can run line-by-line, you’ll want to use a debugger, particularly when you have nested function calls.</p>
<p>Debugging can be a slow process, so you typically start a debugging session by deciding which line in your code you would like to start tracing the behavior from, and you place a <em>breakpoint</em>. Then you can have the debugger run the program up to that point and stop at it, allowing you to:</p>
<ol type="1">
<li>inspect the current state of variables,</li>
<li>step through the code line by line,</li>
<li>step over or into functions as they are called, and</li>
<li>resume program execution.</li>
</ol>
<p>The <em>stack</em> is the series of nested function calls. When an error occurs, Python will print the <em>stack trace</em> showing the sequence of calls leading to the error. This can be helpful and distracting/confusing.</p>
<p>We’ll use the debugger in JupyterLab; similar functionality is in VS Code. And you can use <code>pdb</code> directly from the command line; the ideas are all the same.</p>
<section id="demo-debugging-the-binary_search-example" class="level2">
<h2 class="anchored" data-anchor-id="demo-debugging-the-binary_search-example">Demo: debugging the <code>binary_search</code> example</h2>
<p>The function <code>binary_search()</code> in the <code>binary_search.py</code> module attempts to do a binary search for an item in a sorted list. It looks in the middle of the list and if the value in the list is larger than the item, it recurses to look in the first half of the list, otherwise in the second half. It continues in this fashion until it is down to a single item and then checks if that item is what is being searched for.</p>
<div id="0e818532" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> binary_search <span class="im">as</span> bs</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>bs.search([<span class="dv">3</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">13</span>,<span class="dv">17</span>,<span class="dv">203</span>,<span class="dv">205</span>],<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>0</code></pre>
</div>
</div>
<div id="7f2e95bc" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>bs.search([<span class="dv">3</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">13</span>,<span class="dv">17</span>,<span class="dv">203</span>,<span class="dv">205</span>],<span class="dv">13</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>-1</code></pre>
</div>
</div>
<div id="ad7a5c3a" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>bs.search([<span class="dv">3</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">13</span>,<span class="dv">17</span>,<span class="dv">203</span>,<span class="dv">205</span>],<span class="dv">17</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>4</code></pre>
</div>
</div>
<p>Clearly that doesn’t always work. Let’s debug the failing case.</p>
<p>We’ll work in our Jupyter notebook.</p>
<ul>
<li>First turn on debugging capability by clicking on the small “bug” icon in the upper right (next to the info about the kernel).</li>
<li>Next we click on a line of code to set a breakpoint.</li>
<li>Now we run the function. We can:
<ul>
<li>step within a function,</li>
<li>step into a function, or</li>
<li>step out of a function.</li>
</ul></li>
</ul>
</section>
<section id="exercise-debugging-your-newton-code" class="level2">
<h2 class="anchored" data-anchor-id="exercise-debugging-your-newton-code">Exercise: debugging your Newton code</h2>
<p>Run your Newton method on the following function, <code>x^4/4 - x^3 -x</code>. Sometimes it should fail.</p>
<p>Use the debugger to try to see what goes wrong. (For our purposes here, do this using the debugger, don’t figure it out from first principles mathematically or graphically.)</p>
<p>You can use a conditional breakpoint to try to detect when the next step will be extreme.</p>
</section>
</section>
<section id="defensive-programming-error-checking-and-testing" class="level1">
<h1>6. Defensive programming, error checking and testing</h1>
<section id="demo-unit-tests-and-pytest" class="level2">
<h2 class="anchored" data-anchor-id="demo-unit-tests-and-pytest">Demo: Unit tests and <code>pytest</code></h2>
<p><code>pytest</code> is a very popular package/framework for testing.</p>
<p>We create test functions that check for the expected result.</p>
<p>We use <code>assert</code> statements which are ways of generally setting up sanity checks in your code. These are usually used in development, or perhaps data analysis workflows, rather than production code. They are a core part of setting up tests such as here with <code>pytest</code>.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> tests</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> test_bs.py tests/.</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="ex">pytest</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="exercise-test-cases" class="level2">
<h2 class="anchored" data-anchor-id="exercise-test-cases">Exercise: Test cases</h2>
<p>With a partner, brainstorm some test cases for your implementation of Newton’s method in terms of the user’s function and input values.</p>
<p>You’ll want to consider cases where Newton’s method fails and test whether the user gets an informative result. Of course as a starting point, the case we used for the debugging exercise is a good one for a failing case.</p>
<p>We’ll collect some possible tests once each group has had a chance to brainstorm.</p>
</section>
<section id="exercise-unit-tests" class="level2">
<h2 class="anchored" data-anchor-id="exercise-unit-tests">Exercise: Unit tests</h2>
<p>We’ll implement our test cases as unit tests using the <code>pytest</code> package.</p>
<p>Include tests for:</p>
<ul>
<li>successful optimization</li>
<li>unsuccessful optimization</li>
<li>invalid user inputs</li>
</ul>
<p>with the expected output being what you <em>want</em> to happen, not necessarily what your function does.</p>
<p>You’ll want cases where you know the correct answer. Start simple.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Only write tests now
</div>
</div>
<div class="callout-body-container callout-body">
<p>For now don’t modify your code even if you start to suspect how it might fail. Writing the tests and then modifying code so they pass is an example of <em>test-driven development</em>.</p>
</div>
</div>
</section>
<section id="exercise-error-trapping-robust-code-and-defensive-programming" class="level2">
<h2 class="anchored" data-anchor-id="exercise-error-trapping-robust-code-and-defensive-programming">Exercise: Error trapping, robust code, and defensive programming</h2>
<p>Now we’ll try to go beyond simply returning a failed result and see if we can trap problems early on and write more robust code.</p>
<p>Work on the following improvements:</p>
<ul>
<li>Check user inputs are valid.</li>
<li>Add warnings to the user if it seems that Newton’s method is taking a bad step.</li>
<li>Modify your function so that when it fails, the result is informative to the user.
<ul>
<li>Include a success/failure code (flag) in your output.</li>
</ul></li>
</ul>
<p>Next, if you have time, consider robustifying your code if you have time:</p>
<ul>
<li>What might you do if the next step is worse than the current position? [TODO: backtrack]</li>
<li>What might you do if the next step is outside the range of potential values (assuming a unimodal function)? [TODO: bisect]</li>
</ul>
</section>
</section>
<section id="multi-user-git" class="level1">
<h1>7. Multi-user Git</h1>
<p>Once you are working on more complicated projects and particularly when working with multiple people, you’ll want to be able to use branches and pull requests (PRs) to manage the work.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why use branches and pull requests?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>Experiment without worrying about breaking the current code.</li>
<li>Test your code before finalizing changes (particularly with testing via continuous integration / GitHub Actions).</li>
<li>Organize aspects of the project for clarity and collaboration.</li>
<li>Manage collaboration:
<ul>
<li>Manage code contributions from others.</li>
<li>Discuss changes.</li>
<li>Keep track of changes.</li>
<li>Accept external contributions.</li>
<li>Resolve conflicts between different changes.</li>
</ul></li>
</ul>
</div>
</div>
</div>
<p>Before going further, let’s review our visualization of working with Git (<a href="https://docs.google.com/presentation/d/1YlM3boYLE8DwbxGNO3ZVVt3e9gEoBgD1uc9RtItUYCU">online version</a>, <a href="git_visuals.pdf">PDF version</a>)</p>
<section id="demo-branching-and-pull-requests-merge-conflicts" class="level2">
<h2 class="anchored" data-anchor-id="demo-branching-and-pull-requests-merge-conflicts">Demo: Branching and pull requests, merge conflicts</h2>
<p>We’ll demo the use of branching and PRs by fixing our <code>binary_search</code> function.</p>
<section id="branching" class="level3">
<h3 class="anchored" data-anchor-id="branching">Branching</h3>
<p>First, let’s fix the error in our <code>binary_search</code> function in a new branch.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> switch <span class="at">-c</span> fix_midpoint_bug</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>We’ll now make the fixes and do the linting (not shown).</p>
<p>Push the branch with the fix to GitHub.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> add test.py</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">-m</span><span class="st">"Fix bug in handling midpoint.</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="st">Lint code."</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> push <span class="at">-u</span> origin fix_midpoint_bug</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="pull-requests" class="level3">
<h3 class="anchored" data-anchor-id="pull-requests">Pull requests</h3>
<p>Now we’ll go to GitHub and start a pull request (PR).</p>
<p>Since we’re the ones who control the repo, we’ll also review and merge in the PR.</p>
</section>
<section id="merge-conflicts" class="level3">
<h3 class="anchored" data-anchor-id="merge-conflicts">Merge conflicts</h3>
<p>Next let’s see a basic example of a <em>merge conflict</em>, which occurs when two commits modify (which could include deletion) the same line in a file. In this case Git requires the user to figure out what should be done.</p>
<p>To get an example, we need to create a conflict. I will add different documentation in the <code>main</code> and <code>fix_midpoint_bug</code> branches. After pushing the <code>main</code> change, I’ll try to do a PR with the <code>fix_midpoint_bug</code>.</p>
<p>The GitHub UI does a nice job of helping you resolve merge conflicts, as we’ll see.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Resolving conflicts at the command line
</div>
</div>
<div class="callout-body-container callout-body">
<p>You can also get (and resolve) merge conflicts on the command line. Once you edit the conflicted file to fix the conflict, you can do <code>git add &lt;name_of_file&gt;</code> and then <code>git commit</code>.</p>
</div>
</div>
</section>
</section>
<section id="multivariate-newtons-method" class="level2">
<h2 class="anchored" data-anchor-id="multivariate-newtons-method">Multivariate Newton’s method</h2>
<p>Recall that Newton’s method optimizes some objective function, <span class="math inline">\(f(x)\)</span> as a function of univariate or multivariate <span class="math inline">\(x\)</span>, where <span class="math inline">\(f(x)\)</span> is univariate.</p>
<p>The multivariate method extends the univariate, using the gradient (first derivative) vector and Hessian (second derivative) matrix.</p>
<p>If we are at step <span class="math inline">\(t-1\)</span>, the next value is:</p>
<p><span class="math display">\[
x_{t+1}=x_{t}-H_{f}(x_{t})^{-1}\nabla f(x_{t})
\]</span></p>
<p>where <span class="math inline">\(\nabla f(x_{t}\)</span> is the gradient (first derivative with respect to each element of <span class="math inline">\(x\)</span>) and <span class="math inline">\(H_{f}(x_{t})\)</span> is the Hessian matrix (second derivatives with respect to all pairs of the elements of <span class="math inline">\(x\)</span>).</p>
<p>Here are the steps:</p>
<ul>
<li>determine a starting value, <span class="math inline">\(x_0\)</span>.</li>
<li>iterate:
<ul>
<li>at step <span class="math inline">\(t\)</span>, the next value (the update) is given by the equation above</li>
<li>stop when <span class="math inline">\(\left\Vert x_{t} - x_{t-1} \right\Vert\)</span> is “small”</li>
</ul></li>
</ul>
</section>
<section id="exercise-branching" class="level2">
<h2 class="anchored" data-anchor-id="exercise-branching">Exercise: Branching</h2>
<p>Working with a partner:</p>
<ol type="1">
<li>Choose either your repository or your partner’s repository to continue working in.</li>
<li>Make a branch (called <code>multivariate</code>) in which you’ll implement the multivariate version of Newton’s method (see details above)</li>
<li>Implement the algorithm.</li>
</ol>
<p>At this point, if we think about calculating the Hessian it starts to feel more tedious to deal with the finite difference calculations, though it is a straightforward extension of what you already implemented. Feel free to look online to find a Python package that implements finite difference estimation of derivatives and use that in your code.</p>
<p>As you are writing the code, you can continue to think about what might go wrong and include defensive programming tactics.</p>
</section>
<section id="exercise-pull-requests" class="level2">
<h2 class="anchored" data-anchor-id="exercise-pull-requests">Exercise: Pull requests</h2>
<p>When you have your branch ready, make a pull request:</p>
<ol type="1">
<li><p>Make a pull request into the remote for the repository by pushing the branch to GitHub</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> push <span class="at">-u</span> origin multivariate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Go to GitHub to the <code>Pull requests</code> tab and make the PR, making a note of what the PR is about.</p></li>
</ol>
<p>Don’t (yet) merge in the PR.</p>
</section>
<section id="exercise-code-review-1" class="level2">
<h2 class="anchored" data-anchor-id="exercise-code-review-1">Exercise: Code review</h2>
<p>Now you and your partner should find a separate group with which to work on code reviews as a “supergroup”.</p>
<p>Give the other group the URL for your repository on GitHub and ask them to look at the PR. In turn get the URL for their repository.</p>
<p>In reviewing the PR, make comments in the PR comment/conversation area on GitHub.</p>
<p>If you have time, explore these two options for making comments:</p>
<ol type="1">
<li>Review changes:
<ul>
<li>Click on the <code>Files changed</code> tab (or go to <code>https://github.com/nimble-dev/nimble/pull/&lt;PULL_ID&gt;/files</code> for the specific “PULL_ID”).</li>
<li>Click on the <code>Review changes</code> button.</li>
</ul></li>
<li>Make comments on specific lines
<ul>
<li>Click on the <code>Files changed</code> tab (or go to <code>https://github.com/nimble-dev/nimble/pull/&lt;PULL_ID&gt;/files</code> for the specific “PULL_ID”).</li>
<li>Hover over a specific line in a specific file with your mouse. A blue “plus” box should appear. Click on the plus to add a comment.</li>
<li>Click on <code>Add single comment</code> or optionally experiment with <code>Start a review</code>.</li>
</ul></li>
</ol>
</section>
<section id="exercise-merge-the-pr" class="level2">
<h2 class="anchored" data-anchor-id="exercise-merge-the-pr">Exercise: Merge the PR</h2>
<p>Once you’ve seen the review by the other group, with your partner:</p>
<ul>
<li>On DataHub, make changes to the branch that was used in the pull request.
<ul>
<li>Alternatively, you could make the changes directly on GitHub using its editing capabilities.</li>
</ul></li>
<li>On DataHub, commit and push to GitHub.</li>
<li>On GitHub, merge in the pull request and close the request.</li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The full cycle of “git virtue”
</div>
</div>
<div class="callout-body-container callout-body">
<p>Congratulations. In the course of the day, you’ve worked through the steps of complete, albeit small, project using an extensive set of concepts, skills, and tools used in real world projects.</p>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/berkeley-scf\.github\.io\/compute-skills-2024");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>